module Adv04 where

import Data.List.Split
import Data.Map
import Data.Char (isDigit, isHexDigit)
import qualified Data.List

input = "eyr:2027\nhcl:#602927\nhgt:186cm byr:1939 iyr:2019 pid:552194973 ecl:hzl\n\npid:657988073 eyr:2020 byr:1996\necl:brn\nhcl:#866857 iyr:2015\nhgt:164cm\n\nhcl:#fffffd\nbyr:1951 cid:321 iyr:2017 eyr:2022 ecl:brn hgt:62in pid:#6ef4e1\n\neyr:2025 iyr:2011\nbyr:1980\nhcl:#fffffd cid:129 pid:420023864\nhgt:150cm\necl:brn\n\neyr:2029\nhcl:#ceb3a1 hgt:187cm\nbyr:1925 ecl:amb pid:223151011 iyr:2016\n\nhcl:#cfa07d ecl:brn eyr:2022 pid:135392110 iyr:2010\nhgt:190cm\nbyr:1959\n\neyr:2024 cid:225 iyr:2018\npid:522856696 byr:1961\nhcl:#a97842 ecl:grn\n\neyr:2024 byr:1964 ecl:brn iyr:1976\nhcl:#866857 hgt:190cm pid:562135232\n\nhgt:193cm pid:#6e4342 iyr:2011 byr:1936 cid:296 hcl:z\necl:#3b8ed3 eyr:2022\n\ncid:154 byr:1985\npid:503255860 ecl:gry eyr:2023\nhcl:#efcc98 iyr:2014\n\neyr:2026 iyr:2012 pid:631051435 byr:1986\necl:amb\nhgt:154cm hcl:#341e13\n\nhcl:#623a2f\npid:318048681 ecl:brn\neyr:2035\nhgt:155cm\ncid:179\nbyr:1984\niyr:2019\n\niyr:2013 hcl:#733820\neyr:2024 hgt:189cm ecl:amb byr:1969 pid:185953891\n\nhcl:#cfa07d\necl:#38f2a6 iyr:2013 hgt:61cm eyr:2021\nbyr:2012 pid:33668114\n\npid:47030948 hcl:4946ca iyr:2019\nhgt:189\necl:#1d136d byr:2013 eyr:2024 cid:51\n\necl:grn iyr:2011 hgt:162cm byr:1935 hcl:#c0946f\npid:883047970 cid:51\neyr:2020\n\npid:013760919\niyr:2018\nbyr:1942 ecl:blu hcl:#623a2f eyr:2020\ncid:221 hgt:155cm\n\nhgt:152cm eyr:2030 ecl:amb iyr:1986 hcl:#7d3b0c pid:29797863\nbyr:2000\n\nhgt:176cm\nbyr:1995 pid:546676799 iyr:2013 ecl:brn hcl:#fffffd\neyr:2023\n\nbyr:1955 pid:634493767\neyr:2028 iyr:2015 ecl:oth\n\nhcl:#7d3b0c iyr:2020 cid:150 hgt:174cm pid:893757190\neyr:2027 ecl:oth byr:2002\n\neyr:2029 pid:790648045 byr:1978\niyr:2012 hcl:#efcc98 ecl:blu hgt:66in cid:256\n\niyr:2020\nbyr:1945 hgt:155cm\ncid:209\neyr:2027\nhcl:#0eeb2d ecl:hzl pid:048725571\n\nhcl:#cfa07d byr:2000 iyr:2011\npid:381372526 ecl:oth eyr:2023 hgt:162cm\n\necl:blu pid:544462408 eyr:2030 hgt:171cm iyr:2018\nhcl:#602927 byr:1994\n\nhcl:#733820\niyr:2011 hgt:187cm ecl:hzl pid:533405863 byr:1962 cid:266\neyr:2025\n\nbyr:1975\nhcl:#b6652a\niyr:2019 pid:967013712\neyr:2029 hgt:155cm\necl:oth\n\niyr:2010\neyr:2022 ecl:amb pid:052112145 byr:1982 hgt:190cm hcl:#b6652a\n\niyr:2012 hgt:183cm hcl:#b6652a\nbyr:1950 ecl:hzl pid:946714779 eyr:2030\n\neyr:2027\npid:686010502\ncid:103 byr:1993 hcl:#ceb3a1 ecl:gry hgt:70in iyr:2018\n\nhcl:#733820 iyr:2012 hgt:157cm byr:1976\neyr:2030 ecl:gry\n\necl:hzl byr:1955 hgt:180cm iyr:2017 eyr:2022 hcl:#6b5442\npid:732940101\n\ncid:299 hgt:188cm byr:1924 ecl:oth pid:905274031 iyr:2010 eyr:2024 hcl:#18171d\n\neyr:2024\nhgt:174cm byr:1999 iyr:2013\npid:021076124 hcl:#7f450a ecl:gry\n\nhcl:#866857\niyr:2016 ecl:oth hgt:176cm\nbyr:1940\npid:398320693 eyr:2026\n\nhgt:172cm eyr:2020\nhcl:#733820 iyr:1931 ecl:#a0c290 pid:158cm\n\necl:blu iyr:2018 eyr:2025\nhcl:#341e13\nbyr:1990 pid:444561212 hgt:182cm\n\nhcl:#602927 hgt:165cm pid:240732315 ecl:oth\neyr:2023 byr:1976\n\niyr:2016 ecl:brn pid:377612846 eyr:2021\nbyr:1967 hcl:#733820 hgt:153cm\n\nhgt:187cm\niyr:2018\neyr:2030 ecl:blu byr:1925\nhcl:#733820 cid:114\npid:207103786\n\nhgt:184cm ecl:blu\ncid:111 iyr:2018\npid:361909532 eyr:2025\n\necl:grn byr:1968 iyr:2019\nhgt:184cm\npid:381103495 hcl:#7d3b0c eyr:2026\n\niyr:2019 byr:1945\npid:727826617 hcl:#01adfd eyr:2020\nhgt:151cm\n\ncid:280\niyr:2011 hcl:#efcc98 ecl:hzl eyr:2029 byr:1924 hgt:171cm\npid:235809608\n\nhcl:#602927 byr:1973 pid:599786261 eyr:2029 hgt:172cm iyr:2010 ecl:gry cid:97\n\niyr:2017\neyr:2027\npid:768895320 hgt:163cm hcl:#866857\nbyr:1940 ecl:oth\n\nhgt:178cm hcl:#6b5442 iyr:2013 byr:1959 pid:823221334\n\niyr:2014 pid:534201972 ecl:hzl hgt:150cm\nhcl:#da8af3 byr:1945 cid:263\neyr:2024\n\npid:469575516\nhgt:189cm byr:1994 eyr:2025\niyr:2010 ecl:blu hcl:#efcc98\ncid:341\n\ncid:167 eyr:2024 byr:1999 pid:797138561 hcl:#888785\nhgt:60in iyr:2015\n\niyr:2014 hcl:#866857 cid:103\npid:909549652 byr:1967 hgt:174cm ecl:amb\neyr:2023\n\npid:813003671 ecl:oth hgt:61in cid:95\niyr:2016 byr:1995 eyr:2027\n\neyr:2021\nhcl:#fffffd\npid:000088706 iyr:2014 ecl:blu\nhgt:166cm byr:1951\n\ncid:287\necl:grn byr:1941 iyr:2017 hcl:#18171d hgt:162cm pid:511728076 eyr:2022\n\npid:209898040 byr:1968 eyr:2025 hcl:#18171d\necl:brn iyr:2017\nhgt:191cm\n\nbyr:1932\nhcl:z hgt:190cm\ncid:201 iyr:2016 pid:#02dfcc ecl:#6b9341 eyr:2004\n\niyr:2013 hcl:#ceb3a1\nhgt:191cm pid:501799813\necl:hzl\nbyr:1993 eyr:2020\n\necl:blu cid:315\npid:897450687 hgt:179cm byr:1984 eyr:2029 iyr:2012 hcl:#a97842\n\niyr:2011 ecl:gry hcl:#6b5442 pid:299193732 eyr:2020 byr:1945 hgt:190in\n\nhgt:158cm eyr:2022 pid:090738381 byr:1992 iyr:2017\nhcl:#fffffd ecl:oth\n\neyr:2028 cid:92 ecl:amb hcl:#573edf pid:765588435\niyr:2016\nhgt:179cm\nbyr:2002\n\neyr:2025\npid:128081454 hcl:#967d2f hgt:190cm iyr:2015 ecl:oth\n\nhgt:189cm eyr:2025\necl:gry\nhcl:#888785\nbyr:1993 pid:001825574 cid:239 iyr:2019\n\nbyr:2013 pid:0758189515 hcl:z eyr:2034 iyr:1971 ecl:gry hgt:100\n\neyr:2026 byr:1943 hcl:#3638a2 iyr:2011 pid:539139386\nhgt:156cm ecl:hzl\n\neyr:2030 pid:016597738 iyr:2017\nhgt:173cm ecl:brn hcl:#733820 byr:1956\n\neyr:2028\niyr:2018\npid:822607758 hcl:#cfa07d ecl:brn hgt:167cm byr:1974\n\neyr:2020\nbyr:1980\nhgt:65in iyr:2020\necl:oth hcl:#efcc98\npid:397182705\n\niyr:2015 byr:1954\nhcl:#ceb3a1 eyr:2024 pid:398087239\n\ncid:256 hcl:234fc4 ecl:zzz\nhgt:177in eyr:2027 iyr:2015 pid:159cm byr:2022\n\niyr:2018 cid:209 hcl:#a928b0 byr:1976 ecl:hzl pid:920448637 eyr:2025 hgt:158cm\n\npid:96925844 iyr:2016 eyr:2030 hcl:#888785 ecl:gry\nbyr:1984 cid:223 hgt:165cm\n\nbyr:1964 pid:831479208 hgt:153cm iyr:2014\neyr:2024\necl:brn hcl:#18171d\n\niyr:2019 ecl:brn\nhgt:185cm\nbyr:1958 hcl:#ceb3a1\neyr:2026\npid:827043482\n\niyr:2020 hgt:67in cid:116\nhcl:#733820 ecl:blu pid:426593479 byr:1922 eyr:2026\n\neyr:2022 hcl:#fffffd\ncid:330 pid:951768959 byr:1969 iyr:2019 hgt:156cm\n\neyr:2030 ecl:oth byr:1929\nhgt:151cm cid:223 hcl:#111544 pid:083495633\niyr:2019\n\neyr:2025\niyr:2016 ecl:blu hgt:166cm byr:1967\npid:739606431\n\neyr:2021 ecl:gry hcl:#ceb3a1\npid:788420638 byr:1922 iyr:2020 hgt:161cm\n\nbyr:1956 eyr:2025\nhcl:#888785 ecl:oth\npid:705051840\nhgt:158cm\n\npid:047851403 byr:1937 hcl:#cfa07d\niyr:2015\nhgt:192cm eyr:2025\n\nhgt:178cm cid:194\niyr:2019 byr:1923 hcl:#c0946f pid:411527076 ecl:gry eyr:2022\n\nhgt:186cm\niyr:2014 byr:1956 eyr:2027 ecl:brn\npid:976268893 hcl:#341e13\n\niyr:2011 cid:81 hcl:#18171d hgt:183cm byr:1958 ecl:brn eyr:2025 pid:389943720\n\neyr:2028 byr:1972 ecl:amb hcl:#c0946f pid:593351635 hgt:165cm\n\niyr:2012 byr:1991 ecl:blu hcl:#341e13 hgt:169cm cid:156 pid:599766528\n\nbyr:2029\nhgt:75cm\npid:319443119 iyr:2001 eyr:2020 cid:306 ecl:zzz\n\nhcl:#866857 cid:273 ecl:grn byr:1948 hgt:167cm iyr:2014 pid:256331758 eyr:2021\n\niyr:2016 eyr:2024 ecl:oth hcl:#733820\nbyr:1977\npid:423680717 hgt:158cm cid:241\n\nhcl:#341e13 pid:788619400 byr:1954 ecl:hzl cid:153 hgt:185cm eyr:2024 iyr:2017\n\nhcl:#cfa07d ecl:blu hgt:161cm eyr:2026 pid:621023569 byr:1928 iyr:2016\n\ncid:91\nbyr:2024 hgt:168in\niyr:1951\necl:xry\neyr:1979\nhcl:aa8fc8\npid:166cm\n\neyr:2028 cid:155 hgt:159cm\nbyr:1952\npid:875326712\necl:brn\niyr:2012\nhcl:#18171d\n\neyr:2026 hcl:#733820 byr:1990\nhgt:163cm\necl:amb iyr:2015 pid:162682954\n\niyr:2020 pid:936952728 byr:1969 ecl:brn\nhgt:151cm hcl:#c0946f eyr:2029\n\nhgt:189cm pid:132928469\necl:amb hcl:#866857\nbyr:1928 eyr:2026 iyr:2013\n\necl:grn pid:185240766 iyr:2012\nhgt:190cm byr:1952 hcl:#623a2f\neyr:2020\n\nbyr:2021\neyr:2026 hgt:67cm ecl:#ef67e5 hcl:z iyr:1935\npid:4900748653 cid:64\n\nhgt:69in hcl:#7d3b0c cid:248\neyr:2022 pid:076116194 byr:1979\necl:gry iyr:2016\n\nbyr:1991 eyr:2021 hgt:180cm iyr:2020\ncid:127 ecl:blu\nhcl:#44e350\n\nbyr:1954 hcl:#733820 iyr:2018 pid:002868205\nhgt:150cm\necl:brn\neyr:2021\n\npid:524531652 hcl:#623a2f cid:80\necl:amb\niyr:2017\neyr:2020 hgt:170cm byr:1927\n\npid:424660272 iyr:2018 hcl:#efcc98 eyr:2021 cid:238 hgt:187cm byr:1970 ecl:blu\n\nbyr:1923\npid:946014113 cid:273\niyr:2013 hgt:175cm ecl:brn hcl:#602927 eyr:2020\n\nhcl:#6b5442 cid:88 ecl:gry iyr:2012 byr:1929\nhgt:71in\neyr:2022 pid:581329373\n\neyr:1960\necl:oth\niyr:2017 pid:022131529 cid:79\nhgt:184\nbyr:2005 hcl:#6b5442\n\neyr:2030 pid:422677836 iyr:2011\nhcl:#fffffd byr:1925 hgt:60in ecl:gry\n\ncid:325 hgt:158cm byr:1971 ecl:hzl pid:517329528 hcl:#18171d eyr:2026 iyr:2011\n\nbyr:1937\ncid:259\neyr:2030 hgt:176cm ecl:blu pid:321795494 iyr:2017\n\npid:551525002\necl:grn\neyr:2026 iyr:2013 cid:230 hgt:74in hcl:#cfa07d byr:1954\n\npid:004366607\nhcl:c39522 hgt:66cm\necl:#21a3e9 eyr:2024 cid:139\n\necl:xry\neyr:2037 byr:2016 iyr:1994 cid:98 pid:522572315\nhgt:158cm hcl:0ee9d4\n\ncid:70 eyr:2028 hgt:179cm\npid:073189127 ecl:grn iyr:2018 hcl:#142217\nbyr:1977\n\npid:045852463\ncid:69 iyr:2020 ecl:brn byr:1948 eyr:2020 hgt:64in hcl:#733820\n\ncid:268\nbyr:1970 eyr:2025 hgt:178cm pid:512594967 iyr:2011 ecl:brn hcl:#733820\n\neyr:2025 hcl:#18171d\niyr:2014 byr:1950 hgt:161cm\npid:329927551\n\nbyr:1956 eyr:2024 hgt:163cm pid:965746490\nhcl:#a97842 ecl:brn\ncid:100 iyr:2010\n\ncid:112 eyr:2027 pid:864571411 hgt:190cm\niyr:2011 byr:1962 ecl:grn hcl:#602927\n\necl:gry cid:54 iyr:2011 hcl:#6b5442 byr:1922\neyr:2025 pid:689641249\nhgt:159cm\n\neyr:2028\ncid:323 iyr:2020\nhgt:158cm\necl:hzl pid:876082513 byr:1941\n\nhcl:#18171d hgt:160cm pid:910116712\necl:oth iyr:2014 byr:1927\neyr:2023\ncid:226\n\niyr:2030 hcl:#602927 eyr:2030 ecl:grn cid:183 hgt:186cm byr:1963\npid:706533329\n\ncid:279\neyr:2026 iyr:2015 byr:1958 pid:120633047 hgt:150cm\necl:hzl hcl:#866857\n\niyr:2019\nbyr:1989 hcl:#733820 ecl:hzl pid:470596304 hgt:187cm eyr:2022\n\neyr:2027 hcl:#888785 cid:346\niyr:2013 hgt:167cm ecl:hzl byr:1994 pid:528844948\n\nhcl:#fffffd pid:969181309\niyr:2014\nhgt:192cm eyr:2025 byr:1970\necl:amb\n\neyr:2026 iyr:2012\nhcl:#341e13 ecl:oth pid:053348609\nbyr:1931 hgt:167cm\n\neyr:2029 ecl:grn pid:030276279 iyr:2013 hgt:182cm hcl:#fffffd\nbyr:1967\n\nbyr:1949\neyr:2022\nhcl:#ceb3a1 iyr:2016 ecl:oth hgt:177cm\ncid:224 pid:745439371\n\niyr:2016 byr:1940 eyr:2028 pid:351021541 hcl:#341e13 ecl:amb hgt:64in\n\ncid:309\nhgt:74in pid:698666542\nhcl:#866857 ecl:oth byr:1953\niyr:2019\neyr:2021\n\niyr:2013\nbyr:1979 eyr:2023 hgt:186cm ecl:brn\ncid:236\npid:727367898\nhcl:#733820\n\nhgt:65cm byr:1956\neyr:2025 pid:371685442 iyr:2016 ecl:oth cid:245 hcl:#623a2f\n\nhgt:155cm ecl:grn hcl:#888785\neyr:2027 iyr:2010 byr:1927\npid:916070590\n\nhgt:179cm\necl:blu hcl:#866857 byr:1993 iyr:2019 cid:332 eyr:2022 pid:354895012\n\niyr:2029 hgt:69cm\nhcl:#efcc98\npid:179cm cid:216 byr:2007 ecl:oth\neyr:2025\n\niyr:1988 hgt:187 hcl:z\necl:#30e67c byr:2020\npid:225115160 eyr:2037\n\neyr:2021 iyr:2011 hgt:188cm\necl:hzl\nbyr:1965 pid:455044780\n\necl:gry pid:750994177\nbyr:2002\niyr:2016\neyr:2023 hgt:61in\nhcl:#fffffd\n\niyr:2020\necl:gry pid:304482618\nhcl:#18171d eyr:2027\nbyr:1955 hgt:177cm\n\nhgt:187cm byr:1981 pid:795201673\neyr:2020\ncid:154\nhcl:#b6652a iyr:2017 ecl:oth\n\necl:gry byr:1954 hgt:151cm iyr:2019\ncid:101\neyr:2026 hcl:#cfa07d pid:930011749\n\necl:zzz eyr:1955 pid:#d45ed4 cid:338 iyr:2030 hcl:z\nbyr:1999\n\neyr:2020 pid:861636258 hgt:166cm hcl:#7d3b0c ecl:brn\niyr:2018 cid:125 byr:1958\n\niyr:2014 eyr:2022\nhgt:67\nhcl:#7d3b0c ecl:brn byr:1935 pid:409864761\n\nhcl:#866857 iyr:2012 cid:94\npid:483584137 byr:2000 ecl:blu hgt:178cm eyr:2022\n\nbyr:1946 ecl:hzl iyr:2015 eyr:2028 hgt:184cm\nhcl:#602927\npid:947292495\n\nbyr:1974 cid:96 hgt:59in eyr:2028 pid:358779220 hcl:#6b5442 ecl:gry iyr:2014\n\nhcl:#61154f byr:1932\nhgt:167cm ecl:brn cid:126 eyr:2022\n\necl:gry\niyr:2014 hgt:169cm\nbyr:1926 eyr:2020\nhcl:#866857\npid:463772660\n\npid:654733578 ecl:hzl cid:111 iyr:2010\nhcl:#fffffd eyr:2024 hgt:191cm byr:1943\n\neyr:2021\nhgt:74cm hcl:#c0946f iyr:2026\npid:164776417 byr:1977\n\necl:#6db74f iyr:1921 pid:442332495\nbyr:2018\nhcl:z cid:101 eyr:1949\n\ncid:332 byr:2022\necl:blu\neyr:2038\niyr:1939\nhcl:518816 hgt:191cm\npid:10107923\n\npid:168853141 iyr:2010 eyr:2021 byr:1996 ecl:hzl hgt:183cm\nhcl:#733820\n\nhgt:62in pid:556617728\nhcl:336a3b eyr:2023\nbyr:2029\necl:xry iyr:2016\ncid:89\n\necl:hzl hcl:#efcc98\niyr:2020 cid:297 hgt:181cm\npid:075811396 eyr:2023 byr:1960\n\neyr:2030 hcl:#602927 ecl:brn\niyr:2015 hgt:75in byr:1995\n\necl:grn cid:237 hcl:#8936bb hgt:183cm eyr:2028\niyr:2015 byr:1998\n\npid:550427102 hgt:67in byr:1991 ecl:gry hcl:#efcc98\n\ncid:274 hgt:70cm\niyr:2022 eyr:1961 hcl:00f05b\nbyr:1948 ecl:gmt\n\necl:blu iyr:2018\nhgt:153cm eyr:2020 pid:831302208 byr:1927 hcl:#18171d cid:150\n\niyr:2018\nbyr:1973 hcl:#ceb3a1\ncid:215\nhgt:192cm pid:770473271 eyr:2027 ecl:blu\n\niyr:2019 eyr:2021 hcl:#623a2f ecl:hzl hgt:174cm byr:1962\npid:589533254\n\niyr:2012 ecl:hzl\nhgt:184cm cid:292 byr:1991 pid:677889195 hcl:#a97842\n\niyr:2010\npid:#4f47c3\nhgt:154in\ncid:69\nhcl:z byr:2022\necl:#e36a65\n\necl:#5ff50c pid:499582878 hcl:#b6652a hgt:171cm iyr:2016\nbyr:1930 eyr:2024\n\nhgt:159cm byr:1936 eyr:2028\nhcl:#6b5442 ecl:amb iyr:2015 pid:658019126\n\nbyr:1928 pid:599970280 eyr:2026 ecl:grn hgt:158cm hcl:#18171d\ncid:239 iyr:2013\n\npid:684820830 hgt:182cm ecl:oth hcl:#c0946f eyr:2023\niyr:2018\n\niyr:2019 ecl:blu pid:668361647 cid:348\nbyr:1952 hcl:#602927\neyr:2021 hgt:71in\n\nhgt:165cm\necl:grn eyr:2030 iyr:2010 pid:256350027 hcl:#7d5994 cid:193 byr:1947\n\nhcl:#602927 iyr:2019 ecl:gry eyr:2029\nbyr:1931 cid:118 hgt:153cm pid:911300650\n\neyr:2025 hgt:154cm\nhcl:#866857 iyr:2016 ecl:grn pid:515526226 byr:1936\n\nhcl:#623a2f hgt:160cm iyr:2019 ecl:oth\npid:932621460\neyr:2030\nbyr:1990\n\nhcl:#623a2f ecl:blu eyr:2027 cid:277 pid:662549708\nbyr:1949 iyr:2016 hgt:176cm\n\niyr:2010 eyr:2021\nbyr:1947\npid:223603325 ecl:gry\n\necl:gry pid:145738978 eyr:2029 iyr:2020\nhcl:#733820 byr:1949 hgt:183cm\n\nhgt:63in eyr:2028 iyr:2011 hcl:#a97842 byr:1941 ecl:gry\npid:091089766\n\nhcl:#fffffd\ncid:275 hgt:157cm\neyr:2021 byr:1978\necl:hzl iyr:2020 pid:242258232\n\npid:239061408 ecl:oth\neyr:2023 iyr:2011 hgt:192cm byr:1949 hcl:#733820 cid:132\n\nbyr:1954\nhgt:152cm ecl:brn pid:667414305 eyr:2021\ncid:282\niyr:2014\nhcl:#341e13\n\niyr:2018\npid:745564182 hgt:186cm eyr:2028 hcl:#7d3b0c byr:1935 ecl:gry\n\niyr:2014\neyr:2026 hcl:d26483\nbyr:1972 pid:611712147 hgt:163cm ecl:#57d27c\n\ncid:322 eyr:2025 byr:1937\niyr:2020\necl:blu hcl:#cfa07d hgt:158cm\npid:150255302\n\neyr:2030 iyr:2011 hcl:#866857 byr:1974 ecl:blu pid:755213661 hgt:155cm\ncid:116\n\nhcl:#866857 pid:679616797\necl:gry hgt:166cm byr:1999 iyr:2014 eyr:2025\n\niyr:2019 hcl:#fffffd\nhgt:158cm\neyr:2028 pid:835993614 byr:1920\n\necl:brn pid:742320152 iyr:2013\nhgt:151cm eyr:2025 cid:63 byr:1931 hcl:#200aaa\n\nbyr:1950 cid:155 ecl:xry\nhgt:150cm\niyr:2014\neyr:2027 hcl:#615954 pid:596469710\n\nbyr:1946 hgt:166cm ecl:gry\nhcl:#18171d cid:261 iyr:2016 pid:267318602 eyr:2021\n\necl:gry hgt:185cm iyr:2013 pid:092573029\neyr:2023 byr:1956 hcl:#b6652a\n\nbyr:1997 hgt:172cm eyr:2021 iyr:2014 pid:337403043\necl:blu hcl:#efcc98\n\nhgt:190cm iyr:2015 byr:1949 eyr:2023\npid:230935940\n\nbyr:1980 hgt:171cm eyr:2021 pid:9435249395\necl:oth\nhcl:#a97842\niyr:2017\n\nbyr:2011 hcl:#b6652a eyr:2039 ecl:hzl iyr:1923\nhgt:186cm pid:239188418 cid:93\n\npid:791787662 cid:51 ecl:gry hcl:#602927 hgt:160cm iyr:2020\neyr:2028 byr:1975\n\necl:amb pid:720900081 byr:1978 hcl:#a97842 hgt:183cm iyr:2016\neyr:2022\n\neyr:2027 hgt:157cm pid:628454234\nhcl:#18171d ecl:gry iyr:2017 cid:345 byr:1988\n\nbyr:1985 pid:996422540\niyr:2013 hgt:66in ecl:grn\neyr:2020 hcl:#341e13\n\neyr:2022\npid:186cm\ncid:214 iyr:2017 hcl:#866857 ecl:brn byr:1988 hgt:161cm\n\niyr:2019 eyr:2025 pid:752184592 hgt:154cm byr:1966 hcl:#18171d cid:119 ecl:grn\n\nhcl:#b6652a cid:100 byr:1974 pid:477922277 eyr:2024 ecl:grn iyr:2011 hgt:59in\n\niyr:2013 ecl:brn\nhgt:184cm eyr:2023 byr:1969\npid:514127885 hcl:#6b5442\n\nhcl:#cfa07d\niyr:2020 byr:1923 ecl:gry hgt:64in eyr:2029 cid:111\n\nbyr:1921 hgt:73in pid:971490088 iyr:2016 eyr:2025 hcl:#866857 cid:271 ecl:blu\n\necl:oth\neyr:2023 iyr:2019 hgt:179cm\nbyr:1953 pid:226869705 hcl:#602927\ncid:63\n\nhgt:175cm ecl:hzl iyr:2010 byr:1938 eyr:2021 pid:718683561 hcl:#341e13\n\niyr:2023 hgt:189in byr:2030 pid:171cm ecl:#447c00 hcl:z eyr:2022\n\necl:blu eyr:2026\nhgt:191cm iyr:2020 hcl:#888785 pid:128824091 cid:99 byr:1982\n\neyr:2026 pid:333173949 iyr:2017 ecl:oth byr:1928 hcl:#fffffd\nhgt:151cm\n\nhcl:#6b5442 ecl:grn byr:1945\npid:888990994\ncid:168 eyr:2026 iyr:2016\nhgt:158cm\n\necl:grn iyr:2013\nbyr:1931 pid:716975878 hgt:168cm hcl:#cfa07d eyr:2023\n\npid:815050555\necl:blu\nhgt:161cm hcl:#888785 eyr:2025\niyr:2020 byr:1980\n\npid:470039281\nbyr:1967 iyr:2017\necl:gry eyr:2021\nhgt:171cm\nhcl:#7d3b0c\n\nhcl:#bdf8d6 iyr:2018 byr:1954 eyr:2030\necl:blu hgt:184cm pid:694267794\n\nhcl:#cfa07d byr:1971 ecl:brn\niyr:2016 hgt:167cm eyr:2027 pid:237865320\n\nbyr:1921 eyr:2028\niyr:2014 pid:186145415 cid:215 ecl:oth hgt:176cm\nhcl:#a97842\n\npid:925805272\nhcl:#7d3b0c\neyr:2030\nhgt:65in ecl:blu\n\nbyr:1992\ncid:278\necl:oth hgt:65in hcl:#c0946f\niyr:2013\npid:092712496 eyr:2024\n\nhgt:151cm\niyr:2018 hcl:#18171d\nbyr:1971 pid:599220575 cid:321\neyr:2030\necl:brn\n\nbyr:1956 iyr:2016 hcl:#b6652a\npid:109381754\necl:hzl cid:233\n\niyr:2015 byr:1988\nhcl:#866857 ecl:amb\npid:274656754\nhgt:152cm eyr:2022\n\neyr:2028 ecl:amb cid:285\nbyr:1947\nhgt:186cm pid:165847317 hcl:#733820 iyr:2013\n\nhcl:#866857 pid:601229952 eyr:2023 ecl:brn\nhgt:191cm\ncid:183\n\nhgt:191cm iyr:2018 hcl:#b50bab byr:1936 eyr:2025 pid:422563929 ecl:oth\n\necl:gry\neyr:2025 hgt:181cm\nhcl:#a97842\nbyr:1971 iyr:2010 pid:267796608\n\nhcl:#0fd3b0 eyr:2030\niyr:2014 ecl:oth pid:606512017 hgt:173cm cid:301\nbyr:1999\n\nbyr:1937 cid:277\npid:148179917 hgt:179cm hcl:#602927 iyr:2018\neyr:2029 ecl:grn\n\nhcl:#7d3b0c\nbyr:1960\necl:hzl hgt:162cm\niyr:2015 pid:014246579\neyr:2023\n\necl:blu eyr:2020\niyr:2011 byr:1955 hcl:#777876 hgt:188cm pid:988764375\n\niyr:2012 ecl:amb hcl:#18171d\npid:524961020 byr:1983 hgt:173cm eyr:2028\n\nhgt:153cm hcl:#efcc98 pid:127759635\niyr:2019 byr:1932\necl:hzl eyr:2020\n\neyr:2025 pid:421725637\necl:gry iyr:2013\nhcl:#c0946f\nbyr:1971\n\niyr:2015 pid:654033544\ncid:176\nhgt:163cm\nbyr:1923 ecl:brn hcl:#866857\n\nhcl:#623a2f byr:2013\nhgt:76cm ecl:#5cd4a8 iyr:2007\neyr:2035 cid:128 pid:122621229\n\nhcl:#927794 iyr:2019 byr:1964 hgt:158cm\necl:oth pid:269737193 eyr:2025\n\niyr:2014 cid:181\necl:blu byr:1949 hcl:#341e13 eyr:2026 pid:120077363 hgt:174cm\n\ncid:161 eyr:2024 hcl:z\npid:638178037 hgt:151cm byr:1920 ecl:oth\niyr:2011\n\necl:brn eyr:2023 hgt:161cm hcl:#a97842 byr:1977 cid:79 pid:177001463 iyr:2014\n\nbyr:1938 eyr:1967\necl:grn pid:302413712 hcl:#888785 hgt:183cm iyr:2010\n\nhgt:164cm\nbyr:1955 pid:772380994 iyr:2015 hcl:#c0946f eyr:2025 ecl:amb\n\nhcl:#602927\neyr:2021 byr:1924 hgt:171cm cid:161 ecl:amb iyr:2019\n\nhgt:119\nhcl:7d1404 eyr:1957\npid:143311761 iyr:2027\nbyr:1939 ecl:#de1d21\n\nhgt:182cm\niyr:2015 ecl:blu cid:205 pid:136552613 hcl:#ceb3a1 byr:1992\n\necl:blu iyr:2013 cid:54 byr:1998\nhcl:z hgt:172cm eyr:2034 pid:#ec3c3a\n\nbyr:1975 ecl:blu eyr:2025 hcl:#623a2f\npid:358585328\niyr:2012\n\npid:282306278\nbyr:1958 ecl:grn hgt:190cm iyr:2020 hcl:#18171d cid:276 eyr:2024\n\nbyr:1955 eyr:2028 iyr:2017\nhgt:177cm ecl:grn\npid:111002386 hcl:#6b5442\n\neyr:2026 pid:694088201 hcl:#866857 hgt:169cm byr:1957 ecl:amb iyr:2018 cid:109\n\nhgt:171cm ecl:blu iyr:2013\neyr:2021\nhcl:#6b5442 byr:1965\npid:268169550\n\npid:803092066\neyr:2023 iyr:2010 hcl:#a97842 ecl:grn byr:1956 hgt:191cm cid:173\n\neyr:2024\niyr:2012 byr:1991 ecl:gry pid:946620993\nhgt:190cm hcl:#b6652a cid:181\n\niyr:2019 hcl:#cfa07d cid:75 hgt:175cm\neyr:2022 pid:062548271 ecl:oth\n\ncid:262\nbyr:1956\niyr:2014 pid:860561420 hcl:#888785 hgt:176cm\n\nhcl:#efcc98 hgt:188cm pid:828180303 iyr:2013 byr:1932 ecl:gry eyr:2028\n\neyr:2029\nhcl:#341e13 byr:1992 ecl:brn iyr:2012 cid:292\npid:644391775 hgt:150cm\n\necl:grn hgt:182cm eyr:2026 hcl:#ceb3a1 byr:1982 pid:625704144 iyr:2013\n\nbyr:1926\niyr:2013 ecl:brn hcl:#812218 eyr:2025 hgt:150cm pid:610910806\n\nhgt:61in byr:1926 iyr:2017 eyr:2020 ecl:oth\nhcl:#623a2f pid:347974562\n\nhgt:185cm eyr:2023 ecl:blu byr:1940 pid:123961293 iyr:2014\nhcl:#a97842\n\niyr:2011 byr:1984 hgt:172cm eyr:2020 hcl:#692e6c ecl:grn pid:342962046\n\necl:blu hcl:#b08932 pid:343331979\niyr:2019\nhgt:193cm byr:1985\ncid:269 eyr:2023\n\nhcl:#fffffd ecl:blu\npid:483091240\niyr:2011 eyr:2022 byr:1988\n\niyr:2019\nhgt:177cm\npid:516533115\ncid:294 ecl:amb hcl:#ceb3a1 byr:1922\n\nbyr:1965 eyr:2023 hcl:#cfa07d\niyr:2013\nhgt:193cm ecl:grn\npid:931305875\n\necl:hzl\nbyr:1944 hgt:164cm\nhcl:#fffffd\niyr:2019 eyr:2029 pid:141532765 cid:209\n\niyr:2013 hgt:189cm\necl:brn\npid:604140631 eyr:2022 hcl:#ceb3a1\nbyr:1935\n\necl:amb hcl:#888785 byr:1959\ncid:287 pid:849438430 hgt:152cm\neyr:2027\niyr:2020\n\nbyr:1988 hcl:#623a2f eyr:2029 ecl:brn iyr:2018 hgt:167cm pid:470443459\n\ncid:276\nhcl:#341e13\neyr:2021\niyr:2012 ecl:hzl hgt:175cm\nbyr:2027 pid:271833606\n\neyr:2027\niyr:2010 pid:970527839 hgt:164cm byr:1974 hcl:#623a2f\necl:amb\n\neyr:2020 ecl:grn byr:1932 iyr:2013 pid:104193512\nhcl:#c0946f\n\neyr:2030\nbyr:1982 hgt:65in ecl:blu\nhcl:#623a2f\npid:570953460 iyr:2020\n\neyr:2020 byr:1922\nhcl:#602927 pid:803264417 iyr:2019\necl:grn\nhgt:169cm\n\necl:amb hcl:#866857 byr:1963 hgt:170cm\neyr:2028\npid:762546796 iyr:2017\n\neyr:2035 pid:54291174\ncid:184\niyr:1980 hgt:176cm ecl:gry hcl:#733820 byr:1974\n\niyr:2013 hcl:#c0946f pid:408646971 hgt:63in cid:84\nbyr:1951\necl:amb eyr:2028\n\neyr:2021 hcl:#6b5442 byr:1994 hgt:170cm ecl:amb pid:348959147\niyr:2013\n\nbyr:1957\necl:hzl hgt:156cm pid:890752588 eyr:2025\nhcl:e7c520 cid:199 iyr:2017\n\nhgt:169cm iyr:2016\ncid:180 hcl:#733820 eyr:2024 ecl:hzl pid:661114936 byr:1928\n\niyr:2015 eyr:2020 byr:1941 hgt:179cm pid:148063033\nhcl:#6b5442 ecl:brn\n\niyr:1935 pid:14292032 byr:2020\neyr:1956 ecl:#c9bc33\nhgt:59cm hcl:#cfa07d\n\nhgt:165cm iyr:2010\neyr:2023\nhcl:#733820 pid:312465756\ncid:112 byr:1993 ecl:amb\n\neyr:2032 ecl:grt iyr:1963\nbyr:1964\npid:#f5628c\nhcl:z hgt:111\n\nhgt:169cm iyr:2012\nhcl:#623a2f cid:291 ecl:oth\npid:809080900 byr:1979 eyr:2023\n\niyr:2021 eyr:2033 ecl:gmt hgt:59cm byr:1967\npid:2498700612\n\nbyr:1953 ecl:oth iyr:2013\nhcl:#b6652a pid:442586860\n\npid:095687847 eyr:2022 hgt:151cm byr:1967 iyr:2017 ecl:oth hcl:#866857\n\nhcl:#866857 pid:983640144 hgt:61cm\necl:hzl\nbyr:1991\niyr:1930 eyr:2024\n\necl:oth hcl:#602927 eyr:2025 iyr:2013 hgt:151cm byr:1992 pid:812583062"
reqFields = ["byr", "iyr", "eyr", "hgt", "hcl", "ecl", "pid"]
eyeColors = ["amb", "blu", "brn", "gry", "grn", "hzl", "oth"]

lineToMap line = fromList $ Prelude.map ((\ [x, y] -> (x, y)) . splitOn ":") (words line)

hasAllReqFields :: Map [Char] a -> Bool
hasAllReqFields map = all (`member` map) reqFields

allFieldsValid = Data.Map.foldrWithKey fun True
    where fun key d acc = acc && check key d

check :: String -> String -> Bool
check key d = case key of
    "byr" -> read d `elem` [1920..2002]
    "iyr" -> read d `elem` [2010..2020]
    "eyr" -> read d `elem` [2020..2030]
    "hgt" -> checkHeight d
    "hcl" -> checkHcl d
    "ecl" -> d `elem` eyeColors
    "pid" -> length d == 9 && Prelude.all isDigit d
    "cid" -> True
    _ ->  True

checkHeight d = do
    let (h,unit) = Data.List.splitAt (length d - 2) d
    let height = read h::Int
    case unit of
        "cm" -> height `elem` [150..193]
        "in" -> height `elem` [59..76]
        _ -> False

checkHcl (x:xs) = x=='#' && Prelude.all isHexDigit xs
checkHcl _ = False

common = Prelude.filter hasAllReqFields $ Prelude.map lineToMap $ splitOn "\n\n" input

adv04a = print $ length common

adv04b = print $ length $ Prelude.filter allFieldsValid common

adv04 = do
    adv04a
    adv04b