module Adv02 where

import Data.Bits (Bits (xor))
import Data.List.Split
import Data.Maybe (mapMaybe)
import Debug.Trace
import Text.Read (readMaybe)

data Policy = Policy
  { i1 :: Int,
    i2 :: Int,
    c :: Char,
    pw :: String
  }
  deriving (Show)

input =
  "2-6 c: fcpwjqhcgtffzlbj\n6-9 x: xxxtwlxxx\n5-6 w: wwwwlwwwh\n7-10 q: nfbrgwqlvljgq\n2-3 g: gjggg\n9-11 q: qqqqqqnqgqq\n14-20 b: bbbbbbbbbbbbzwbbbbbb\n2-6 s: sjsssss\n4-13 b: mdbctbzgcpdjbhsdctrd\n5-6 t: tttttt\n7-9 h: zbhhfmwhhpxh\n3-4 t: ttmt\n4-6 j: jjjjjj\n12-13 w: wwwwwwwwwwwwkw\n3-4 f: sgbmjfftf\n11-12 p: pdppppppppcppp\n5-9 q: qqqqqvsqdjq\n5-8 j: qsljqmxwk\n1-7 w: gwvktwwwkwwww\n2-3 w: gvwcvrggjbk\n1-4 d: kddd\n13-14 k: zkkpkkkkkksskp\n2-5 w: wwwwfw\n4-5 n: bnrnlnnkdvhbnnj\n7-17 s: kswscfssbssztsgwmdr\n9-14 h: hhhhhhhvhhhhhbhhhhh\n1-2 s: sgvmzrpssss\n1-4 x: xxvgbxwxqx\n5-9 b: bbbbbbqbdbbzbxb\n6-10 d: ndddkqdddd\n8-9 z: zzqvkhpzzhx\n10-11 k: jrktpgkvkqk\n2-4 l: lklf\n14-16 c: cxqccccccccccctccc\n1-2 g: bsmmpkmd\n4-16 q: vmqdqktlqqnhzqqx\n6-12 k: kqkwkktfbklkjnkqrtmb\n15-16 v: vvvvvvvvvvvvvvxt\n12-13 r: rrrrrrsrrrrrx\n5-7 p: ppbqlppppp\n5-8 s: dxmsqssk\n3-4 m: mxmlmm\n6-7 c: kcfcbhcc\n4-6 z: zzzxzxz\n12-14 r: rrrrmrrrrrrrrkkltr\n4-6 j: zhbtgg\n5-7 r: rrdrrrzrr\n1-3 x: rxcxxxxxxxxxxxxx\n5-7 g: ggggggvgmcg\n12-15 n: nnnnnnnnnnnnnnhn\n4-6 p: qppppppp\n9-12 j: pjjsmbjjjjjj\n3-16 b: bhgbtjhqvkpgcbgbpbz\n2-7 q: mqfhknwswqjxjncxjt\n6-16 c: wclpphqjcmbzdwccp\n13-15 k: dkkdkkkkkkkknkkcn\n7-9 b: blfbbbhvz\n14-18 w: wwwwwwwvwvwwwwwwwc\n11-18 w: xstwwbwwwwwwtrbwww\n3-14 z: zdgxzpvzjztfzzrpjz\n7-10 j: mjrxjstdnj\n10-13 f: ffrfqflffftjkf\n1-4 j: jnjtjfj\n8-9 g: wtbqjjggjfcvgs\n2-7 z: qpwvvjcpzf\n3-4 k: kfgk\n6-12 l: lllllllllllw\n14-15 n: nnnnnnnnnnnnnpr\n10-11 p: prcpwdzmcqp\n12-14 v: vvvrvvvqvvvschvvzvv\n1-11 q: jqqqkfqqqqqqqqwqq\n11-12 j: jjjjjjjjjjtj\n2-6 x: nqxxxx\n7-17 s: blbvqsssssssnslgswz\n9-10 s: ssssssssbsss\n1-2 t: ttvqtt\n3-8 w: bsddhgwb\n1-2 r: jrxdfg\n8-9 j: ljjjjjjljfmj\n1-3 j: jjjjjjjjjdkjj\n4-13 f: jfffmsffmfxrmhnf\n1-4 s: sswvjx\n4-8 b: btfgtwkvdfqkwv\n2-3 p: tptddqdkgdfcbxxrpv\n1-4 p: dspz\n14-16 d: ddddhdvdddddtddh\n6-9 l: hnvrpllsl\n4-5 h: hjhzhnh\n3-10 b: zsvjzttjnbbgdt\n12-15 c: ccjscwcccdcccccl\n1-9 j: xjjjkjjlj\n1-9 m: gngmvxqmmmmhmmml\n9-10 k: kkkkkkkkpc\n13-14 q: qrsxtpgpnhcrkq\n3-6 k: pkjcks\n1-3 t: ttjtt\n10-15 f: sjwnfftrffptbqltg\n3-4 b: nwbtnz\n5-7 k: kkkkkkdk\n14-18 l: lglllllllllllllllrpl\n1-14 q: fqqqqqqdqqqqvd\n16-18 p: pppppppppppppppppn\n3-7 l: lllllgvx\n2-5 b: pbbkcbbbbbg\n7-9 c: bcnjkzxccl\n4-5 x: cwxxfxtmqtxxp\n10-11 d: dddddwcxdvddbdddd\n3-5 v: vvvvlvv\n4-7 m: mmmmmltldmmmbk\n13-14 s: sssssssssssssks\n4-6 s: ssslszs\n15-16 z: dzbzfxmpzhrrszzf\n5-12 x: xrzxxxgxtcxxxxxx\n17-19 g: ggggggggggggggxwjgq\n12-13 n: nnnnnnhnnnnjn\n8-10 l: llllllltllldlll\n9-14 t: fttftqttmtkstdf\n4-11 l: nnlljlhllllx\n5-7 q: qhpzqjl\n2-6 v: fglnsvvwlpx\n2-3 b: mbvbb\n4-9 w: wwqwwwjwmz\n1-4 j: jjxpmsk\n6-8 c: pckczdcccncr\n3-6 x: xbslxxzhqn\n11-17 j: jdkjkjjjjbjxjjjjsj\n4-8 h: hphbzhjh\n12-14 x: xxxxxrxxxxxxxrx\n2-4 q: kqgm\n1-14 r: lrtrzrrrsrrzrr\n5-15 w: tpwwwbdlbxczwcgwnvbw\n1-4 p: qppsppp\n1-9 z: zzzzzzzzzzzzzz\n8-12 t: tttttttbttst\n2-3 n: bkfn\n5-8 w: xwwwwwwdw\n9-10 c: csdccccqcgcbxcn\n3-5 v: mvfvvqvvm\n2-5 r: rrstrnzfrdwrvbpfqz\n1-4 m: mmmmmmmmmmmmmmmmm\n8-9 m: mmmmmmmmg\n3-6 l: llllll\n3-5 j: jjgjft\n10-11 b: xtlppqfbnkq\n15-17 p: pppxpppfppppppppb\n7-8 f: ffbmfffd\n6-11 t: htgvbttnjzpkt\n5-6 t: tvttwt\n8-10 b: bbqbrtbrbb\n6-10 x: xxspxkxmpxxxvrcxx\n3-6 f: lgrxkfrfkfj\n1-7 f: fffffftf\n5-6 t: rcjtqtwvgsttc\n12-13 k: kkmgwdjmgpkkgrkk\n1-13 w: dwdwzlwxrtvhwwhmwj\n3-13 n: nnwnnnnnnnfnnnnn\n9-10 j: kbjjcsjtjn\n17-18 v: vvvvvvvvvvvvvvvvvh\n11-17 z: zzqkzzzzdzhzgzzzvzz\n7-11 f: nrdftjqffff\n3-8 t: tttttttctt\n4-5 r: rrcrwrf\n5-7 c: ccqccccccc\n13-14 r: rrdrrrfrrrrrhrr\n9-12 s: xjddslskrjpd\n8-9 n: nnnpgnnbnnnn\n6-10 j: wjjdjjjjjpjjjj\n1-7 z: hzzzzzzzz\n4-7 b: bbbzbbbxlb\n4-13 t: tttqnttttkxtt\n6-9 h: vhphhzhhshh\n2-10 p: bpfwnncsmtppppsq\n3-19 n: dnklnrnnnnfnnnngndn\n5-15 n: nnnnknnnnnnnnnsnnnn\n6-8 t: trttttwv\n8-12 m: mtmmbkmxmjdjmmmtm\n2-8 k: kjkkkkkkkk\n6-8 n: xrnmndqn\n13-16 n: nnnnnnnnnnnndnnnnnn\n14-15 c: cswjctfcccrccxc\n2-9 k: knkkkkkkj\n5-12 r: rxrfwrdrcmdr\n6-11 v: vxwsnvnxvgs\n12-13 n: nnnnnnnnprnnmn\n1-3 l: blbz\n4-7 h: hhhbhhh\n8-12 m: mqhrnmzmmmmmm\n6-15 n: nnnnnpnnnbnnnnzn\n3-6 q: lzjcxqpmjqsbqgxjql\n6-7 q: qqqnqrq\n5-7 q: qtlhqct\n3-5 q: qlxmq\n2-3 n: knnn\n4-5 z: zzzzh\n4-9 r: rrrwlprfrlrnpzrrmwt\n14-15 j: fchdfjzmdrjxrxj\n1-4 m: dmmm\n2-4 x: wxkmpxn\n5-11 r: rvblrrjkvrsbr\n1-2 c: ntcmkz\n14-16 h: hhhhhhhhhhfhhhhhhh\n1-3 h: cnsvhm\n4-5 w: wwwww\n7-10 j: jjjjjjjjjsjjj\n9-14 j: zjjjjjjjkjjjjwj\n12-13 k: nqwkrcpkkkkkkk\n3-5 k: vxkkj\n6-7 j: pjjjtjpjjjw\n2-3 j: jjsg\n4-5 g: ggggcg\n3-5 b: wbbnvxw\n2-4 h: gwjhqj\n3-4 l: ltlm\n8-10 j: bjpdpvtjdj\n1-7 v: vbfvvsvcvv\n11-16 j: jbjhjjjjjjjjjjjc\n6-13 b: bmswrnbdhbrfbmbb\n1-4 x: xxxh\n4-10 c: wjgcwbrkxk\n11-13 v: sfbcphvzttvmzv\n6-16 q: pqqqqqqqqqqqqqqq\n10-12 w: wwwwwwwwwswww\n2-9 b: fbwwwbrdp\n3-4 v: vvnvvvvv\n8-14 x: drwxxvqdgmpxmxfcxr\n8-10 k: kkkkklkkkc\n4-7 j: jcwrjjjfc\n3-4 c: cczcgc\n3-12 l: smllklclprdvlsl\n1-2 j: fjqd\n10-19 g: gggggggggqggggggggxg\n3-5 m: fpmmmvb\n2-3 c: ccmc\n3-7 v: pvqktqh\n1-3 c: ccfv\n4-5 x: khxxj\n3-4 g: ggbgf\n1-9 x: xxhxxxxxx\n5-6 f: zfffmfff\n5-8 l: gmlqlkrl\n7-10 c: ccccckcscsb\n1-3 p: spppp\n1-3 v: qmvvv\n15-16 z: czhzzzzzpzzzzzzkzz\n2-4 r: rrrr\n3-13 k: kktkkgkkkkkkgkk\n10-13 p: bpqpxpqqtprjn\n6-7 j: jwnjjjxj\n2-8 w: wmgwdwww\n12-14 g: gggggggcgggggg\n4-8 f: mdffklwtcj\n2-7 j: jmjxjdxjrbrjjdjjrjwj\n3-4 m: mmml\n5-7 l: wllkqll\n6-10 s: ssqcpssddslxncsbs\n6-11 n: nnnvnznnnnwn\n9-10 w: cbbqgrqglwgqskw\n1-8 v: nvvzlhcvvvslv\n1-3 t: tttttt\n3-6 f: mftpff\n1-11 t: pmjtttttttl\n8-11 h: hhkmfhvhnwwhhhhhhh\n4-6 k: kkkrkkkb\n2-17 x: zzxxzvrsbmjxnxxxx\n5-6 d: zdhxdldm\n1-4 c: nmcc\n2-4 j: njjjj\n7-13 s: jjsbqrsddsclpvs\n10-15 f: mbffrlpjtptgfff\n10-13 d: dddddvddddddv\n8-9 g: gxhgkggrgc\n2-4 b: tbbcnkvp\n9-11 g: ggggghgldgpggvg\n4-5 m: mmmvm\n2-5 d: ddfdp\n8-11 r: rrrsrlcmltgrrbr\n9-11 r: rrgrrrrxwrrr\n3-11 g: zgggvgdggdsj\n13-15 x: xxxxxxxvkxxxrxlbxx\n13-16 b: bbbrbbpbbfcbqbbxbbb\n7-10 x: jxlhxxxxxbx\n1-12 p: plkprppjpppb\n9-10 t: ttttttttft\n1-5 q: qqqsqqjsqp\n6-9 m: mzmmmlqmmgm\n6-7 j: pbjjkjcj\n8-9 b: bbbbbbbbxb\n1-2 c: cflj\n12-15 c: xskhcckcttmtmfc\n5-6 p: pppppb\n10-18 v: vjrplvzjxmjvvrvvfvd\n3-5 x: hvfqxxqzqz\n1-10 t: sttttttbttftttttttt\n4-7 f: nrxknwf\n3-9 l: fllltcllltlsjlc\n10-16 x: cxxxxhxjrxxqjxxkxcx\n10-14 m: mdmmmcmmmmmmmmmm\n2-17 n: nmnnnnnnnnnnnnnnnn\n7-11 s: dtpqdssfbbsrl\n1-4 h: hhqh\n2-7 j: jjrbbmjps\n3-4 d: dhsddvflkqdvgd\n6-7 m: gmmmpmr\n2-9 j: jjjjjjjtpjjjjjjjjj\n12-13 g: gggggggtggggz\n16-17 p: ppppppppppppppppspp\n6-8 w: wntlwwwhnwtgwhwjj\n2-4 s: tntsjn\n4-6 t: tgtgtt\n6-7 f: qpffwwfv\n3-5 k: zltkkgsvjhrbxwvkg\n8-10 l: ljlwlgpllkklllflrb\n3-5 q: qqbqqqs\n4-5 f: zfffb\n2-5 b: bbzhbbbb\n4-5 q: sfhqpqtqbrbgdqgqw\n13-14 k: kkkkdkkkkkgtkzpqkkk\n4-9 p: bnpwptvkps\n10-11 n: nnnnnnnnnnsnnn\n12-14 d: ntpzdcqdpsrmddkcwgc\n4-10 g: wgxxgsgggkchgggkg\n2-7 q: qwbqccqlqmqqqsqcw\n3-5 d: ddddddd\n2-4 v: vwsvv\n4-13 p: pppppppprppql\n6-8 s: zcxssstnfr\n8-9 f: zfffcqfff\n10-11 m: qmbmmmmmpmx\n1-3 j: qvjjkn\n14-16 d: zfdmddxdrddvdcdc\n5-10 w: rwwwwwwwwww\n1-4 p: cmpp\n2-3 f: dffff\n4-8 n: nnnznznnn\n1-4 t: bvrntkt\n5-6 v: xjgvnvmgfwxvvv\n2-4 w: tvwgtc\n1-7 f: ffffffdfc\n15-18 w: wwwwwwwwwwwwvwwwwww\n1-2 t: jtct\n2-3 k: cskdkkkl\n3-19 q: qpfqqmqqqqqqqqqqqtqq\n2-9 n: wnnjcngnkdnbnlrcbvns\n1-14 d: vddfpndddfddddjhddd\n1-2 m: bmmbwtwml\n3-4 p: ppgrprpgrqb\n2-3 m: mrmmm\n5-6 l: zllllz\n8-13 k: xkzptdzzkggkv\n5-6 j: jjjjcj\n4-5 b: bbcdfb\n1-2 b: vbmbrbsf\n8-9 q: lqhmjvdqgnxmb\n2-4 n: snmrcnntn\n11-15 r: rrsjrfrmqrlrqrz\n2-3 l: dlblr\n2-3 h: cthlxj\n8-15 l: lllwlllllclfllbl\n6-7 q: hqqqqqjq\n13-14 f: ffffffffffffhf\n2-4 v: dtxvztgnvffxlxfcdwf\n5-11 h: hxhkhpfnhlchh\n3-5 n: nnwcj\n12-15 s: sssssssssmssssrcl\n1-6 d: rdddddddd\n14-15 b: bzbfnbbbbbbbbpxbb\n4-8 w: jkxpzcnwhzsgmbkw\n7-13 t: ttmlfbttdttgtpvktt\n8-11 z: jdqfmwgltdztpzc\n13-17 s: sssshsssssskslsxnss\n9-10 t: tttttttttf\n3-4 l: sllzl\n1-2 s: ksxsxbwjn\n12-17 l: dlvflhjmlgtldlllr\n1-5 f: hfffffhf\n5-12 f: gmklffbffztjfwswdg\n18-19 z: zzzzzzzzzzzzzzzzzqz\n1-5 c: cwccgcc\n3-4 p: pspp\n5-9 n: tknnnnsjwnsntng\n6-7 x: xxxxxxm\n6-10 g: szrpggtlwr\n9-11 s: xgwsbcssxcs\n8-9 t: dtttdtzrt\n5-11 d: snddldcdhdd\n11-13 m: fbkmsdvklzmtmkmmbjq\n10-13 s: nqnsssmsvwrrs\n3-4 w: hwnwk\n5-11 h: ztkpgzhpfhh\n6-7 w: wwwwwwww\n3-4 z: zvzzczzlglv\n13-14 l: llllllllllllll\n12-13 x: xxxwxxxxxxxgx\n3-4 p: mxkppr\n2-3 d: ddbdt\n3-5 l: zlplllphl\n3-7 p: spmrbvp\n4-5 b: bbbvn\n16-17 l: zzxvmvxsgrprbclvl\n4-7 h: hphwfshhrpgdmktsphhl\n1-5 l: nllllll\n4-5 r: rrrnr\n5-9 k: bbkwgkklqkqhkk\n4-5 t: sttnt\n15-16 f: fffjffffffsdffwfsff\n5-8 z: bzzzzjzzzv\n5-7 f: qqzzffmfvb\n3-10 m: zmmpmfcwdmfmvc\n3-4 z: zlzzz\n2-3 c: cjcsl\n5-15 r: mrdznrsrctlrrqrflzm\n8-11 g: ggggggggggdg\n5-10 s: bnshsbvrthssmq\n7-10 m: mmhmmmmmmmm\n14-17 h: hhhhhhhhhhhnmkhhhhh\n1-5 n: nnsnx\n4-17 j: jmxjdkgbhjxflrmqjjdj\n6-8 m: mmmmmmmb\n3-5 p: ppppxrpp\n3-8 t: jtjtttqttt\n17-18 k: xklkkkkkgkfmrkkhkbhh\n1-3 k: kkhk\n13-14 j: jjjjjjjjbjjjgj\n9-12 q: cmwwkzrkqsqqqmqhqb\n3-8 s: sssfclpwhssfss\n3-6 s: mshsfss\n10-16 p: plftpppkpqppppppp\n4-5 d: dddgdq\n4-5 s: slsss\n1-7 z: zzgxkzf\n6-7 w: wwwwlwz\n11-12 w: mqwwwwwwwwbzw\n13-14 t: ttttttttttttlt\n9-10 c: ccccccccvc\n9-13 q: qmqqqqqqhqqqqq\n1-7 z: rzzzzzmzzzzz\n7-16 w: wwwwwwwwwwwwwwwcw\n4-5 m: nkmrmxz\n8-9 q: qqmqqcmqlqqqqw\n10-15 x: ltnxqwwxxztmzhxxmnt\n3-6 r: pkvpfprgwm\n10-11 k: kkkkkkkkkkkk\n3-4 c: ccfjs\n1-6 n: nqvkzjn\n9-12 k: qkhxrknkkzpk\n8-10 x: xxxxxxxxddx\n4-14 t: tttttttttttttbttq\n12-13 h: hhhnhhhhhhhhd\n2-6 x: bdwljxqxhkxjwpvdxk\n3-4 w: kwfw\n5-13 w: skrwgwwdwmcwv\n1-3 m: mtmvsmc\n5-7 v: gvbvvdt\n7-8 s: ssshssspss\n4-14 m: mmbmdbtmvhvmlc\n4-9 g: ggsgnhhmgg\n1-6 g: gsmfgjgzmkglzbgfjw\n1-12 z: zzzzzzzzzzzdz\n4-6 q: dbqjwnd\n9-15 c: ccccccchccjcccc\n1-7 l: fkllkmp\n2-17 g: dggmgzhvphggcjgmtx\n9-10 f: fffffffpfs\n1-4 n: nnnw\n11-12 l: llllllllllrl\n9-10 p: ppppppppppp\n5-6 p: pskgtx\n7-8 q: qqqqqqjr\n7-8 d: ddrdddkgddd\n2-5 l: llllhl\n4-6 h: hhbhlbhh\n9-12 m: mmmmmmqmtmqgcx\n10-13 f: fbfffjffffffjff\n5-14 c: cvvrcmkhztsctfpf\n1-2 k: fkkk\n\
  \8-11 j: kjzchnjlrxjjljjljj\n5-6 x: xxxxxq\n6-11 r: zrkrrrznrfm\n2-5 r: rdrrrr\n12-16 c: cccccccccccccccvcccc\n14-16 w: pwwfwwntkwwrjwcww\n1-16 z: zzzpzmzmdzjzzzzvzzgs\n6-8 j: mttjfgswgjwjjdjx\n1-8 w: hwswwlwwxtgxbgkwp\n7-8 h: hhhhbhnhb\n3-4 n: cnzn\n8-9 r: ltnkhrdsr\n4-5 t: tttmtltptttttttltt\n7-8 s: sssslsscszws\n16-18 j: jjjljjxjjnvjjjjjjnj\n3-4 s: psjpswct\n5-7 b: kslrgbhcxmhbv\n7-9 x: gxxxdxxxbxxx\n1-5 d: lddddd\n12-16 x: gsbzzgxnwsrmqxvx\n10-12 m: mmrmmmmmmmmbmmmmmr\n4-7 f: lfsfcnczbfh\n9-11 r: rrrrrrrrrfzr\n3-6 c: jfhnvcc\n8-19 f: ffffffgfffffffffffj\n2-6 x: lpfxdqws\n1-4 q: xcvqnqvh\n2-11 r: rrrrrrrrrrrcr\n1-5 z: pvdczgkznqpxpnzrz\n2-3 j: rzcjvmjb\n5-6 w: wcwwwlblgplfwft\n3-13 j: djjrjmwzrkzzn\n10-11 p: hlsbzcpdqppww\n9-10 f: fffffffffb\n2-7 m: tvmjknlkdqlqmh\n6-19 x: cqkrszrxppxxzrclxkx\n1-11 m: zfmmjmmmlmmmmmdmm\n3-4 t: fstwjtqqsdzbwrt\n8-9 x: xxxxxxxxg\n4-5 n: xnnnfnnnl\n1-4 n: xxnngpfxl\n5-6 m: tgsmmqm\n10-11 l: lpvhlllrhcn\n11-12 k: kkkkkkkkkfdkk\n14-16 c: cccccccccccccbcc\n13-14 f: ffffffffffffjff\n10-11 w: hwhwqngbwmw\n16-18 m: mmmmmmmmmmmmmmmrmm\n8-12 d: bddddddrddddd\n14-16 z: zzzzzzzzvzkvzzznzz\n9-10 z: fzzzzzzzzbf\n14-15 j: jjjjjjjjjjjjjqjj\n8-11 b: qtfjvqgbpwb\n6-9 d: ddddddddzddddd\n5-7 c: rlqqctcr\n5-6 m: mmkmmfmdwjd\n6-7 n: nnnnnnz\n11-12 s: sssssssssswpsss\n12-15 r: rrrrrrrrvrgrrrk\n2-3 b: bqbbb\n7-9 c: ccccccdcc\n15-17 s: sssssssspsdsssqsssss\n2-7 g: bgggwrbggfc\n4-5 n: ncdnb\n11-12 x: xxxxvxxsxxrxxvx\n4-17 c: crscfpdcrngngctxc\n1-3 s: xsrsss\n14-18 w: wzwwwwpxwwfwwlkwbl\n2-8 w: tbjctwlwml\n1-10 h: xhhfhhgjhhhhhwhz\n13-15 c: cccccccccccclccq\n1-14 j: hjfjjjzsjpjjjjjj\n6-10 c: jccxcccbcc\n5-6 n: nznnnxcnn\n4-10 w: wwwbwwvfwwmwwws\n9-10 s: krsgskgtvl\n2-11 p: pppppcppppspp\n12-14 c: ccccccccccccvcc\n3-13 c: blcvjwrwzzwlmttsncg\n3-9 w: wqwlqwqpdwc\n12-15 v: gtwlqvxjkvvgvft\n14-19 k: kkkkkkkkkkkkkkkkkknk\n4-5 g: gggnx\n3-4 r: rxxrr\n13-14 h: hhhhhhphhhhhch\n11-15 w: wwwwwwwwwwdwwwdw\n16-17 l: jmphnlvdgmltcflxlm\n1-4 q: qmqw\n5-10 f: ffmbxfqffffbfff\n2-14 b: bbbqjbxvdbbvbdx\n18-19 p: ppppppppppppptpppnn\n5-6 m: mmbmmkmm\n3-8 d: ldkddkddmbcdwdrbx\n11-12 s: shjssssssspgssssssss\n2-4 d: fddqdd\n6-11 f: ffffffffcszsrff\n5-10 r: mrrrhrrrrr\n2-17 n: nhtnxnnnnfnnnnnnnn\n3-4 s: ssvs\n5-6 t: ktgbft\n7-10 m: mwmmmlmmmhp\n10-11 c: cccccccccbc\n1-3 t: rnttg\n13-14 f: kjqrkfstrfngqf\n12-15 g: gdgknggggqghgpd\n1-13 t: ttttttgttttttjrttt\n1-5 r: brrgrrrrr\n4-7 c: cccnccccccp\n11-12 n: nnnnnnnnnndl\n9-11 j: jwjjjkjjjjfj\n3-10 w: wdwgswwwwx\n10-12 r: zzrrctnvrxfrrqrrjrrr\n4-5 x: xxxhx\n5-9 j: fqgwpjtjnt\n7-9 l: lxllllllqllwllll\n11-17 p: ptbzpvppswpppplpr\n7-13 g: ggggggzgggggfgg\n2-8 j: pbftjswjqzcp\n5-6 z: zzzzzczzzzzzzzzzzzz\n2-6 n: ntvnnnnnn\n12-13 n: nndntnhknsnnnnnnqfnn\n1-6 x: wtnxdw\n2-4 f: fxxf\n5-12 k: xcxrwkpfkkfkdk\n3-4 z: lzzz\n12-15 n: knnnnnnncnnnnnpnnnn\n3-11 h: jdhfhhfmthh\n9-10 k: kkkkkkhkskk\n2-6 g: hhngvjgbkg\n3-4 k: zkkz\n12-19 r: rrrrrrrrrrpmrrrprrvr\n2-9 d: dkddddddjdddd\n1-4 c: zccc\n7-12 d: dqbxtdxdgztddc\n4-5 x: kxxxd\n1-3 x: xjfkxvhvbq\n5-9 w: dpqcpwcrwpwcqhlj\n1-7 q: dkbtgkqxjhjzsqccn\n4-10 c: cncccccccccc\n7-13 b: bbmbqwbbbbbbbpnbb\n9-10 b: bbbbbwbbbgx\n7-14 b: bbbqjbcpbbjbvbbbqrxb\n5-13 s: fspsqsshvhssssmrqss\n11-15 v: vvvvvvvvvvvvvsjvhvdp\n5-9 d: brwdshwddzvg\n2-7 w: wwkfgkwtbvwx\n6-9 l: llllwnlllll\n4-7 h: hchhhtpr\n1-4 n: npgnn\n3-4 k: kvkkkkjkkxkgkk\n1-13 m: xmkkhmwddbtkm\n6-7 x: xxxxxxr\n15-19 m: mmmmnmmmmmmmkmbmmmd\n14-15 z: zzzzzzzzznzzzhzz\n11-13 h: sfhxhlhtnnkvdkhm\n9-10 z: dzzzvzzzztmhczbzx\n5-7 v: vvvvwvv\n5-7 z: zrgzxzzfdz\n1-3 n: nvlm\n4-7 x: xkvxxjt\n4-10 m: mfwzzmnqfsdkxzmmmm\n1-15 x: xxxxxxxxxxxxxxt\n5-7 n: nnnnnnm\n11-12 z: xknzzzwddzxxzzzzzzhc\n3-4 f: fzflfjf\n4-6 g: ggkgrxg\n1-2 n: sncpt\n4-18 z: xvrsrxzzzzlzzznzzz\n5-7 j: jbhfjcrpkgjhp\n6-7 g: gggggsh\n8-9 n: nnnzntnqpfnnpc\n8-9 k: kkkkkkkxsk\n6-11 n: nnhntnmhnnms\n3-5 q: qzqqqqhlcbfdqq\n6-9 r: rrrrrrrrvdjrrrr\n3-7 r: rrrrqhm\n6-9 t: xmdtvstttjtt\n3-5 l: gnsnlp\n2-6 x: hxjxjd\n2-6 t: tttttp\n7-8 l: vdtrllllrmlwllcplgb\n10-11 t: ttttttztmwtt\n3-4 d: ddgd\n9-11 j: jjjjtnjjqjcjj\n6-7 n: nnnnlcwbn\n4-6 g: ngdsggg\n7-9 q: hnxrvqjqqr\n3-5 l: fltllw\n3-11 g: gghggggggggg\n7-17 w: wwwwwwwvwpwwwmwtgw\n2-19 n: nhnnnnnnnnnnnnnnnnn\n1-2 n: xnmr\n4-6 x: xtxxxpxxxx\n10-13 z: zbzzzpjrwzdzxszzzz\n9-19 b: bbbbbbbbbbbbbbbbbvbb\n9-10 w: wwlwzwwwvr\n5-9 p: pnkpdppppppkpwzpp\n15-17 j: jjvjjvjjjjjjjjljwcj\n3-4 t: tttkt\n1-5 j: jvjtq\n2-11 r: rrrrrrrrrrwr\n1-4 x: xqpzxwcslbj\n3-4 b: bpbp\n11-13 w: wwwwhwwwwwnwl\n2-4 f: nfnjtfkbsxvm\n6-7 v: vvvvvvs\n1-4 t: xwtxxmgfwpkqd\n5-6 h: hgjhrhhhh\n2-4 p: psppp\n10-14 j: pqjjjsjjjbcbjjjjj\n3-7 d: ddbjddgzdd\n6-7 l: llsllbl\n1-13 p: pppppmpppppppppppcpp\n1-3 r: rbdzrjsrd\n11-14 x: xxxxxcxxqxxxxs\n11-12 c: ccccwccczccccc\n2-12 g: spwsxfgdrqngkqgdb\n1-3 h: dhrhh\n1-7 f: tfffffff\n15-16 s: sssssssssssssvssz\n12-13 q: qqzqqqqqqqqvq\n4-5 g: cgxgk\n3-8 n: nnnnnnnnnnnnn\n1-3 r: rrkr\n14-15 g: sgtgggggggggggxgr\n2-5 s: vhcts\n2-4 x: xdbvvrnxxhnzsl\n8-11 p: ppwpppclpvlp\n7-11 b: bblbbkbbbbmxfqgxgk\n5-6 d: dddldffx\n5-6 z: zzzzzwz\n11-15 q: hqrqbzbhnhdqjfqdvg\n3-16 b: btgbbbbhzbbbbbjb\n4-5 f: ffvkf\n6-10 q: qqqqxqqdvlqq\n12-15 g: gggxsgsnwqxldmg\n8-12 d: ddddddjpdddh\n1-2 p: pphgjjm\n9-11 d: ddddddmdfddd\n18-19 z: zzzzzzzzzzzzzzzzzmz\n8-14 r: rrrrrrrtrkrrrq\n4-5 t: jhtrt\n3-6 h: bjhwkpdjqbnng\n4-5 m: mmmmbm\n2-4 t: dqttgszbrwpcdr\n5-7 q: dfxmqxxqtdfqxqq\n3-5 k: kkkcmk\n7-10 t: tttttttttn\n7-14 m: mmhmbmkmmvrtmxgxwmm\n10-11 v: vvvvvzvvcxvvv\n5-6 s: lssssbrssl\n8-15 h: hhbhhhhhwhrhhhqh\n18-19 q: qqqqkqqqqqqqqqqqqtq\n10-12 p: xpprjzzlpqspsnpb\n5-6 t: ttttgt\n4-12 s: csvwsslsshgkbsrds\n12-17 z: zzzzzjfzzzzzzzzzzzz\n4-5 f: fnktwj\n3-6 h: hphdhvh\n16-19 m: mmmmmmmmmmmmmmmnmmmm\n5-8 m: msmjtplmmtqbm\n6-9 q: gqqcqqqrq\n1-10 g: gvgfsqggph\n10-11 l: nlllpllljql\n1-4 q: qqqx\n2-4 q: qbwqwpqq\n3-5 s: scsmjtszkscsds\n2-5 t: txttfttt\n1-2 s: swsqspmz\n2-4 f: vffw\n11-16 r: rrrrrrrrrrjrrrrq\n2-13 r: rlxpzrftnrkhrvlzrp\n4-7 g: lggfgsggggggggggg\n4-5 w: wwblw\n2-5 t: tbgtg\n6-7 n: jvzmhnmnphhx\n1-8 m: cmmhmlmmm\n10-14 x: wtxtkxxjpxxxxr\n3-5 h: hmchhfhk\n5-8 h: qgfkhktmhhhmbw\n10-11 k: kkkkkkkkkkh\n5-6 g: ghzggxgsgpksg\n3-4 w: mwwv\n3-7 p: zppsxpnbj\n1-2 d: qtdd\n9-10 h: rhdhlhhhwhhtdhzxhp\n1-6 v: lvtpvvnb\n2-6 q: qqqlqm\n4-8 j: jjfjjvjjxjj\n13-14 x: xhvqxxxxxxhxxq\n10-13 k: kclwxblmncnbkkdhrhr\n1-3 j: jjpj\n3-4 b: sbmxhbbt\n2-3 d: mjscddjrh\n2-6 x: xxxgxqxxxxzxrxx\n19-20 h: hhshhhhhmshhhhhhhhhq\n12-15 s: scbssrsslnsskfbs\n3-4 p: jpmp\n11-19 p: pppptpppcthpppppppp\n1-5 w: lwwvw\n3-4 d: xzfddddpdddzdjxcdd\n3-8 f: fspmqqkfjtfrz\n9-12 c: cccccccccccr\n15-16 w: wwwwwwwwwwwwpwlg\n2-3 v: vzvb\n10-18 t: txttttmtmtrtntttfktt\n3-12 h: mwbdpslghxxhhh\n2-9 l: lcllllllxllllllll\n9-10 r: rrrrrrjrtrrr\n2-9 m: mmmbmmmmmmmm\n7-13 t: ttttttttttwtz\n7-13 b: bzbbbbqdxbqbb\n5-7 d: ddhdddmd\n4-5 b: bqbdkbbb\n1-3 k: wkkkk\n4-6 d: dddddf\n2-7 j: tmnjptjtrvx\n5-7 z: qzlzzzvzm\n4-5 h: hhhhhf\n3-14 s: zsrkrsssmsssshsssss\n7-8 k: bkkkgkkxk\n8-9 x: xxxxxxxtxm\n7-9 j: jmjjjjljjjjb\n10-11 n: xnnkrqnfnjnnnpncnn\n3-6 c: cxcdlhv\n1-2 q: qdlmfhgtgrnqhmvqmkhm\n6-7 t: tttttttt\n2-4 j: xjvzcjcftgvfqg\n5-7 n: srnxnjjgdnnnnqrwt\n2-3 z: vhzzvk\n6-13 d: nlbwzrpsrfvwddcz\n1-3 s: ssfs\n10-13 n: nnnnnnnnnmnnnnnnn\n6-8 g: lggggnggx\n7-10 j: jjjjjjqjjjj\n2-10 c: fccbgjccvzwqczcvcc\n3-4 p: wqws\n1-6 w: wqbjbnrp\n5-9 v: vvvvvvvvhvvv\n13-16 n: nnnnnnnnnnnntnnn\n5-7 h: qzjhhhp\n14-15 c: ccccccccccccclcc\n11-13 g: tkthwlwggncggxmjfk\n2-11 v: vndvvvvvvvvv\n10-11 p: ppppppppppt\n1-11 c: ccccccccccdc\n9-10 b: bbbfbpbbtbb\n5-10 r: rrsrrrckhp\n2-16 v: vvbktgjvhvvkmfbvccwc\n6-10 v: nrvxrvcvvvktrvvvl\n10-17 d: ddddddqdhdddddddvd\n5-7 f: fqkxhfffghfc\n1-13 z: zkzwcggpsppzzxwcbbp\n2-4 d: hkvdzhlpbqdnvrjsc\n9-11 x: zxxxxxxxsxx\n14-17 q: qqqqqqlqqqvqqgtqq\n5-12 q: qqqqqqqqqqqrqqqqq\n10-13 w: wxwbnbkwgwxwhwwwln\n5-16 c: xzvscccccjcccchhc\n2-3 v: vgmvvvvvvvvv\n7-9 j: mjjjjpjjdjjjb\n6-9 q: gqqqqqqqq\n10-12 p: pcpxppppprpppp\n1-6 s: zsssss\n1-3 g: mhggg\n2-7 g: gsggsgnvggggqggvlgrc\n1-6 d: rddddddd\n1-3 n: nntnknnr\n8-9 t: tttltttttt\n5-6 f: jfzqfljhkwdn\n12-14 j: jljjjjvjjjjjjcj\n9-10 q: qqqqqqqqqwqq\n2-11 h: hhhhhhmhhhqhphhh\n4-9 z: cldzzfxzblb\n3-4 l: lvlm\n3-4 m: mmrmm\n15-18 m: mmmmmmvdmmmmmdmmmsmm\n4-5 f: wffzff\n10-16 b: bbbtmbblpbbbbbmmbv\n13-14 d: dpdmjrgdqrdwwd\n6-7 m: mmmmmjm\n12-19 g: gggggzxggggrgggglgvv\n10-15 p: ppppspbpvpkpcpqppp\n4-10 m: mmmmzmnmpct\n11-12 c: chcccpcccccdcccpd\n3-5 f: ffnzqjzh\n1-6 p: cpjpppp\n7-14 p: ppppnpqpwnrtmbjjppm\n7-8 w: wwwwwwtw\n3-4 d: ddds\n3-4 r: vrxdtlt\n2-7 w: wcwvwwqw\n5-12 b: bbbbbbbbbbbhb\n1-5 t: tlvktt\n6-7 p: mprngps\n8-12 x: xxrbnxxjhxxxxlx\n1-3 x: xvqx\n5-7 v: vvvvqjvvvvsg\n2-6 w: fwwjwz\n16-20 q: qrqqbqnqqfqjhqfqqqqh\n3-6 j: jhjjjfjsjk\n4-9 k: rkgpgskkz\n2-4 z: gzdz\n6-8 t: tttttsttdtttt\n11-12 p: ppppppppppppp\n4-6 x: mzqcfxct\n16-19 d: qjdlfdccdbxngddnkgn\n2-3 f: rrcvqfs\n13-16 z: zzqzzjzzfnttznxzzzz\n16-17 w: rbngvbwpgwgzkwswp\n1-9 k: klkkkkpkp\n3-4 f: fffxffffff\n1-2 l: lhpl\n1-4 w: vznmj\n2-3 j: jdjmpjd\n17-20 v: vvvvvvvvvvfvvvvvvrvx\n3-7 w: wnzwwswwwwj\n3-8 m: mmnmmmmmmm\n3-4 l: llmll\n9-11 r: rrrfrrrdqrwrr\n9-10 w: wwwwwzwwhw\n6-10 t: pttwtbxqgttttntktjt\n1-3 j: jpngpm\n1-9 g: gggggggggg\n4-5 b: gbbtb\n2-6 q: qqblqdrnmcnhqvvpvkq\n6-7 w: zwwwwjw\n2-8 w: rpbbwwwlqzhl\n11-13 b: bbqbbbbbbbbbb\n7-10 v: vvvvfvvvvv\n6-17 t: ttttttttttttttttwt\n2-3 f: fbff\n8-13 l: qlllzllmllgllmlcl\n3-4 n: nnnfnqd\n9-12 z: lzzzlzzzzffb\n3-11 p: bhlpnccgcfp\n1-3 s: stccsf\n10-18 p: pdgpphscppdlpppvsh\n3-6 j: jjjjjq\n2-3 s: dslwlsvljc\n3-7 g: sgggtdgwkdhspgnxkglv\n12-13 h: vrgnfshfssvhh\n12-13 m: mmmmmmmmmmmbgm\n12-16 d: djddvdqpdddddjlt\n3-4 k: kfkmkpk\n6-13 s: ksphskxpdswsssbbnwwt\n6-18 x: xxsvxndxxxxfvkxxbxs\n7-8 d: dxbdddddddd\n6-7 q: qqkqdcqjfdqqbbqp\n4-5 k: vkkbkzqpk\n4-9 l: llbhllllldl\n14-17 d: ddddhdhddddddxdddd\n3-5 r: htlfbsgmvz\n2-4 h: hthhh\n4-7 l: xlzllbqkdwqsllfsw\n17-18 n: wnnrnnnnngnnnnnnqnfn\n1-3 j: vlwkv\n1-2 g: bggz\n10-11 x: ddsxjxxtnxjpcxxxxxv\n4-5 g: hggkg\n5-7 t: khtnzct\n10-15 g: ggkggsggcgggggqggwgg\n9-11 s: ssssbwjhssj\n1-8 b: gxvbllbjqk\n2-3 w: jgwqhrw\n7-8 j: wxtqdvjpbcfzxsjlpmsj\n9-16 b: bcpbcbbbbbjmbpwbbj\n2-5 t: tpttttt\n2-3 z: pzzz\n3-10 j: jjpjjrjjjjjjw\n5-8 t: tttttttxt\n5-15 r: rrnrrrrrrrrrrrkr\n8-9 j: hdjwgbjmj\n3-14 c: jcccwcccccrckccch\n11-12 n: jvzktxgpcmnjglwljrn\n9-13 k: vqsgdcksxtxhks\n3-5 c: zdccczpwlxt\n3-5 r: wxgkrqrsgl\n7-8 s: kspsssksswssj\n3-7 j: djjjhbrkhtncxjvf\n11-12 x: xxxxxxxxxxxz\n11-12 t: ttttttttttht\n8-11 v: ptvvvsvtvrvvwvxvtfg\n9-13 d: nhjddddvlbkdcdntdf\n3-6 w: gnwwjqwzqwm\n3-5 s: tsssc\n3-7 k: kkkzkpmmll\n13-15 k: kgkkkkkkhkkktkf\n5-8 t: ktttrttnt\n1-4 z: nzzzzzz\n2-4 k: lkkc\n2-3 z: szjh\n19-20 d: dddpcddkddckdddbmdld\n3-9 q: xqqqpqqqwlqqqqq\n14-17 s: ssspkssssssssssslss\n17-19 c: ccccccccjcczccccxccc\n4-13 h: qtrhflbfmkfchjmfzph\n10-18 m: nmmmmmmmmmmmmmmmxd\n5-11 n: dnnnfsnnkznbgnjn\n6-11 c: cccccvccccc\n7-9 d: dddddrxdzldv\n2-4 z: zbzz\n1-6 j: njjjjjjpjj\n3-5 p: prpww\n3-16 c: tqjdhbgxvxcxwbvcn\n4-5 c: vclfc\n3-18 x: xxrxxxtxxxxxxxxxxtxx\n2-4 g: gvgggg\n6-12 j: cjjpjjjjlhpt\n3-4 w: pfwq\n5-14 v: vsqqvlrmqbbrlp\n2-12 l: rlblqwmphxzpsp\n2-8 h: hhqqvhhphhhqddhh\n7-9 f: dnfvhwwffk\n4-5 p: ppppcd\n8-14 t: ttttdtqhttttftttt\n13-14 f: fffffffffffffff\n1-6 s: jrtwjslzwgkt\n4-6 c: jcwzhcscc\n10-14 x: llxxxxxxvnxsmx\n1-2 h: hhhhv\n2-4 d: mvdclzddj\n16-17 t: tttttttttttttttmt\n2-3 l: jklzlmzrppdpzt\n5-6 g: rvfgnggjgk\n"

-- input = "1-3 a: abcde\n1-3 b: cdefg\n2-9 c: ccccccccc"
-- input = "1-3 a: abcde"

parse :: String -> Maybe Policy
parse str = do
  [is, c : _, pw] <- pure $ words str
  [i1, i2] <- pure $ splitOn "-" is
  Policy
    <$> readMaybe i1
    <*> readMaybe i2
    <*> pure c
    <*> pure pw

checkA :: Policy -> Bool
checkA policy =
  do
    let count = length $ filter (c policy ==) (pw policy)
    count >= i1 policy && count <= i2 policy

checkB :: Policy -> Bool
checkB policy =
  do
    let a = (== c policy) $ charAt (i1 policy) (pw policy)
    let b = (== c policy) $ charAt (i2 policy) (pw policy)
    xor a b

charAt n s = last $ take n s

count :: [Bool] -> Int
count = length . filter id

day02a = print $ count $ map checkA $ mapMaybe parse $ lines Adv02.input

day02b = print $ count $ map checkB $ mapMaybe parse $ lines Adv02.input

adv02 :: IO ()
adv02 = do
  day02a
  day02b