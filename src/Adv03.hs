module Adv03 where

input = "..#..#......#..#.......#...#.#.\n...##.....##..#..#....#.##.##.#\n...#...#.##...##.....#.....#.#.\n..#....#.....#...##.##.###.#...\n.#.....#......#..#.##.#...###..\n#..#..#.#......#...........###.\n#......####.#....##........##..\n.#.......#.....#......#...#....\n...#...#.....#.......##.....##.\n#...##.........#.#..##..#..#.##\n#.#.##.........#.#..#.#.....###\n.##..##...#....##.....#..#.....\n........#.......###.#.#.....#.#\n...#.#....#.##..#...##..##..#..\n......#....#........######.#...\n.##...#.#...###......#.#.#..#.#\n........#.##...##.#...#..#...##\n.#..#.#..##....###..#.#.......#\n..#..##..#.#...#.##......#.....\n##.....#..##.#.#..#......##...#\n......................#..#..#..\n..#.##....####.........###.##..\n##..###..#...#....#..#.#...#...\n.##.#......#..#....#........#..\n.#.....#..#..#.#.#....#.....##.\n..........#..#....#..##...#..##\n.#...#.#....#.##..#.....#....#.\n#..............#.#.#..#..#....#\n...#.#...............##........\n#.#.##...#.##..##.....#........\n...#.......###..###..#...#..#..\n####..#.#..##.....##.#.#......#\n.#.#.......#..##.......#.......\n#....#...#.##.#.......#..#.....\n.#...##..#..#..##.......##...#.\n.#..#......#.........#.........\n#.##.#.....#....#..##..#.....#.\n#.#....#.#....#...#.#..#....#..\n#..#.....#.##..#.....#...##...#\n#....#...##.#.........#.#....##\n.......##.##......##.......##..\n#.....#..#........#........#...\n#....#.#..#.#........##.#...#..\n#.......#.#.#.#....#.......##.#\n...#..###..........#...#.#.###.\n....#..#....#...#....##.#.....#\n.#..##.....#..#....##..##...#.#\n#.........#....#.#..###...##...\n.#.#.........#.#.......#.#.#..#\n..........#........##..#.......\n.....#.......#...#.....#..##.##\n...#.........#.............####\n##..#...#..#.#......#...#......\n.#..###...#.#.#.#...#...#......\n....#..##.#....#..#.#..##..##.#\n..#.......#......#..#.......#..\n....###......#...##...#....#...\n..#..#.....#...#..###....#.#..#\n.........##..#.##....#..##..#..\n##...#...#.#.........##......#.\n###..#.#....#......##..##.#...#\n.##...##..#.#.#.#......#..#....\n###......#..#..#.....#..#....#.\n.#.#..##....##........##..#.#..\n###...####.#....#.......###....\n..#....###..#.#.#..#.......##..\n.......#.#...#.....#.#....##.#.\n......#......#.#....#..##..###.\n....####..........#.....#......\n.###.....#...#..#...##.#...###.\n...##....##....###....#.#..#.#.\n##.#..........##.........#.##..\n..#..#.#.###..##..#....##.....#\n..#....##.....#...##....###..##\n....#.......##..#..#..........#\n............#..#.###..#.#......\n...........##......#.#.#...#..#\n...##.##....#...##.##.....#.#..\n.####...#....###...#.....#....#\n.##........#..##..#.#.....#....\n..................#.....#..##..\n..###.....#.##..#..#....##...#.\n...#.##.#.####.#.###.#....#..##\n.#....##..##......####.#####...\n#...#.#....##.........##....#..\n..#.##.....##.............#.##.\n###.....#.#..#..#......#.##.#..\n...#..##.....#...##...#......#.\n.##.#...#......##.#..##....#...\n.....##.....#......#.#.........\n#.....#.....#........##........\n.#......##...#..#.#....###.#..#\n#.####...#....#.........#..#...\n#..##.#.....#.##.##.#....#...#.\n#########..#....#..#...#......#\n..##..##...###.######...##.##..\n##.......#.......#.#....###..#.\n.....#...#.######..#.....#.....\n.#......#..#.............#.##.#\n..###.#.#......##...###........\n.......####.#..##....#........#\n..#......#.##....##.##....#....\n....#......#.#....#..#.#.....##\n####.....#....#.#......#.#.#.##\n#...##....#.#.##.........#....#\n....#..###......#......#...#...\n.....##.#..#..#...#..#.#.#.....\n.##............#.....#.........\n##...#..#.....##.#..#..........\n#.....#####.......#..#....#.#..\n.........#..#.....###........#.\n#....#..#...###........#..#.#..\n...##...#..#...#.##..#.........\n.........#.#.....#.......#...#.\n.#.....#..####....#.##.......##\n...............##....##.##..##.\n............#....#....#...##.#.\n..#...#........#.......#..#....\n##....####....#.##...#..##..#.#\n.#.#.....#......#.#........#.#.\n....#......#.#....##..##.......\n.#..#.#..#..##.....#...........\n..#........#.##..#......##..#..\n...##.#...#...#..#........#....\n##..##....#......#...#..#.#.#.#\n......#.....#..#..#....#.......\n.....##......#..#.#.##...#.....\n...#.....#.#..........#..##...#\n.####.##....#...........#.....#\n.....###..##...#....##..#...#..\n..##...#.#...#..........#..#.#.\n...#..#..............#.##.#....\n##.#....#...#..#....#..........\n.##..........#..#........#.....\n#...#.#......#...#.....##..#...\n.##...#.#.#....###.####..#....#\n.#......#.#...#.#....#.#...#...\n#....##.###.............#.#....\n....#.###..##..##.##...##......\n##....#..###.##.##.....#......#\n..#..#..#......#..#..#.........\n#.##......#.#....#..#..#.......\n....#.#...#..###......##.......\n.###.......##.......#....###...\n..#..#.##..#.#....#..#.#.....#.\n.#..##.##..............#....#..\n#...#.#...#..#.##..##.#.#......\n#...#..#..##..##.###......#....\n.#..#.....#...#....#.....#...#.\n.....#....#..#.....###...#.####\n.#.....#......#...##...#..#....\n.#......#............#.#.......\n....##....#.#..#..#...#..#.#...\n#...#.....###...##...#.##.....#\n.......#.....#....#.......#...#\n#.......###.......#.#..........\n...#.#.###.#........#.###...#..\n....#............#....#..#.....\n#......#.##.#...##.......#..#.#\n.....#....#....#.#.#...###..#..\n.....#.#...#...#.#..#....#.#..#\n.#.......#.#..#...###.......##.\n.......#..#.##.........#.......\n.##.#........#.##...##....#....\n.#....#..#...#......####...#..#\n...#.....#..##.#..#.#....#....#\n...##....#........#.#........#.\n.....#....##..#.##..........#..\n#.....#.#.#......##....##.#..#.\n.#.#.##..#.#....##.#....##.....\n.....#.....#..#.#....#..#....##\n...#........#....#......###.#..\n.....##...#.....##.##.#.#.##...\n...#.....#####....##.#.#.###.#.\n.#..#.#..##...###.........#.#.#\n#...#...#.#..#...#...........#.\n.##..............#...#..#....#.\n....###.........#.#.#....#.....\n..#...##.#.#....##.#..#...#..#.\n..#.....#.#......#....#......#.\n.......##....#.#.##....#...#..#\n##.#.#...#..#......#..#..#....#\n...#.#......#............###.##\n..###..#..##..#...##........#..\n.#...#...##...#....#....##.#..#\n..##...####....#....#..#....#.#\n...#......##....#.........##.#.\n##.#.......#..#..#.............\n..#.#.#.#......#...#.#..##.....\n.#..##.....###...##.#..#......#\n##...#..........#.####....##...\n#..........#...#..##....#......\n....##...#....#..####...#.##.##\n.#.######...##...#..##.........\n....##.........#.......##.##...\n.#.....#.#..........##......#..\n...#..#.#.###..#........#.....#\n..##..#............##.......#..\n......##....##..#.##..#.......#\n.......##....#.......#..#...#.#\n#.#......#.###.....#.##........\n.#..##..........#..#.....#.##..\n..#.#...#....#.........#..##..#\n.#......#.......#...#..#..###..\n......#.##.....#.#......#....#.\n....#....#...#.......#...##.##.\n#....#...##...#..##........###.\n##......#.#..#.......#.......#.\n...##.##..#......#.###..#.#.##.\n.............#..#.............#\n..#.......##..#..#....##...#...\n...............##..##........#.\n##...#.##.......#....#.......##\n....##.##.#.#.....##.....##.##.\n#.#......#.......#..#.#..#.....\n....##....#.##........##.##.#..\n......##....#..##..#..##....##.\n.............#.....#.......#...\n.......###.......#..........#..\n......##.#..#.....#.#...#.#...#\n.#...#..#..###.###...#....##...\n#......#..#.#...#...#.....#..##\n.###.....#..#.#......##..#.##..\n.##.#.....#..#.#..#....##......\n#......#..............#.....#.#\n...#..#....#.....#.....##.#...#\n......#..##..##.....#...#......\n.....####..#..#.##.......#..#.#\n###.#.#........#.......#.....##\n..#.#.#.#...#...#........#....#\n....##.#.#..#...##.....#......#\n#..#.##....#..#.##..####.......\n...####.#...#......#......##..#\n#....#.#..###......#..#..##..#.\n...........#....#...#......#...\n......###.#.....#.#....#.#...#.\n.......#.##..............#..##.\n..##...........#..#.#...#.....#\n#..#............##.........#.#.\n.......###.#...#.#...#.#.#...#.\n..#...##.......#..#......#.#.##\n#.#...#.....#...##.#.#.......##\n.#.#.##...#..##.#......#.......\n#.......#.......#.#....#.....#.\n.....#..#..#.......#..#........\n##...##...##......#..##.###....\n..#...#.###.#.###..#.....###...\n.....####.......#.#.....##....#\n....#....#.#....#...#..#.#..#..\n..##.....#....#.#.#.###...#....\n......#.#....#.#..#....#.#..#..\n#...#...#....#.......#......#.#\n#..#.#......#..#...........#.##\n...............#....#.....#...#\n.#.#.#...#.##...#.#.#..#....#..\n...#.#.####..##.#...##.........\n##.........##.##.....##....#...\n................#...#.##.#.#..#\n.#..#....#...#..#..#..###.#..#.\n...#..#.##.#.####..........#..#\n........#....##......#..#.#....\n........##.........#..#..#..#.#\n#......#.#...#...#...##.....#..\n#...#.....#..#..##.#...#.#.#...\n....#..##...##.....#...#.#.....\n..#..##....#....#...#....#.....\n.#..#...##.......###...#...#...\n.#......#......#..##..#..##....\n....##....#..#.#....#.#..##....\n###......#...........#.....###.\n.....#...#..##.#..#..#.....#..#\n#.#....#...........#.##..#..###\n#....#...###.#...#..##..#.....#\n.#....#......##.#..#....#.#....\n....#.#....#..#.#....#..#..#...\n..#......#..#.#.#....#.........\n.#...#.#.....#........#.#...###\n....#..##.......#.###....##....\n#.#.......#......#.###........#\n#.........#.....####.##..#..#..\n.#.#..##...#.#.....##.#.#..#...\n.#..#..#..#.##..#...###.#...#..\n.....##..##..##..#.#.#.....###.\n.#..#...#..#......##.#.........\n....#..##....#.##.........#...#\n........#...#...###.........##.\n#.........#..##....#.#...#.....\n.......#.......#..#.......#....\n#......##......#.#.##..........\n.#..##..####...#.....####.....#\n........#.#....#..##..###.#...#\n.#...#...#.........###..#...#.#\n#.........#....##...#..........\n.#.#....#..........#...........\n.#.#..........#.##.....#.##....\n..#....#...##..###..........##.\n.#.#..#.##..#..#.##.##..##.....\n........#...#....#...#.#..##...\n......#......##..#..#.....#..#.\n.##.#....#...#....#...#..##..##\n##............#..........###...\n....#.......#.#..#.#####.....#.\n#......#.....#...#........#....\n..##.....###..#.#.#.#....#....#\n#...#...#.#..#..#....#..#......\n......#....#...#..#....#####...\n....#.......##....#....##......\n.....##...#.##.#.....##....#...\n.#....###.#..##...##.##.......#\n....#.#.#.##.............#..##.\n...........##......#...#.#.##..\n....##......#....#....##..##.#.\n.#.#...#.....##.....#.........#\n#.#..........#.......#.##...#..\n....#.##..#.#....#.....#...#...\n##.............##.......#.##.#.\n....#...#.....##...#..........#\n##..#...#...#.#.##...#.......##\n..#........#.....###...##..##.#\n.....#...##.#.#.##.....#...#...\n####.###...##..##...#..#..#..##\n......#..#..#.........#...#.#..\n....###.....##.##....#.##.....#\n"

treesForSlope :: Int -> Int -> [String] -> Int
treesForSlope right down xs =
    length $ filter (\(line, i) -> line !! i == '#') $ zip (everyNth down xs) (everyNth right ( cycle  [0 .. width - 1]))
    where
        width = length $ head xs

everyNth :: Int -> [a] -> [a]
everyNth n = map head . takeWhile (not . null) . iterate (drop n)

adv03a :: IO ()
adv03a = do
  let xs = lines input
  print $ treesForSlope 3 1 xs

adv03b :: IO ()
adv03b = do
  let xs = lines input
  print $ product $ map (\(right, down) -> treesForSlope right down xs) [(1, 1), (3, 1), (5, 1), (7, 1), (1, 2)]

adv03 :: IO ()
adv03 = do
  adv03a
  adv03b
